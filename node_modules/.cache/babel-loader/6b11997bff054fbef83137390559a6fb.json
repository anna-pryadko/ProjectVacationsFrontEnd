{"ast":null,"code":"var _jsxFileName = \"/Users/annapryadko/Desktop/GitHub/ReactProjectVacations/projectvacations/src/Components/Login/Login.js\";\nimport React, { Component } from 'react';\nimport axios from \"axios\"; //import Registration from './MyReg';\n\nimport { MDBMask, MDBView, MDBContainer, MDBRow, MDBCol, MDBInput, MDBBtn, MDBCard, MDBCardBody, MDBModalFooter } from 'mdbreact';\nimport { BrowserRouter } from 'react-router-dom';\nimport { Route, Link, Switch, Redirect } from 'react-router-dom';\nimport Registration from '../Registration/Registration'; // import HomeUser from '../Home/HomeUser';\n// import HomeAdmin from '../Home/HomeAdmin';\n// import MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\n// import AppBar from 'material-ui/AppBar';\n// import RaisedButton from 'material-ui/RaisedButton';\n// import TextField from 'material-ui/TextField';\n\nclass Login extends Component {\n  constructor(props, context) {\n    super(props, context);\n    this.state = {\n      userName: \"\",\n      password: \"\",\n      errorName: \"\",\n      errorPassword: \"\",\n      currentUser: {},\n      isLoginSuccess: \"\",\n      foundUsers: [],\n      isLoggedIn: false,\n      // isAdmin:false,\n      cookieArr: [],\n      checkCookie: \"\",\n      userRole: \"\",\n      currentUser: {}\n    };\n\n    this.componentDidMount = () => {\n      if (localStorage.currentUser) {\n        let currUser = JSON.parse(localStorage.currentUser);\n        this.setState({\n          currentUser: currUser\n        });\n        this.setState({\n          userRole: currUser.data[0].role\n        });\n      }\n\n      var self = this;\n      axios.get(\"http://localhost:5000/checkCookie\", {\n        withCredentials: true\n      }).then(function (response) {\n        console.log('checkCookie', response.data); // 1 or 0\n\n        self.setState({\n          checkCookie: response.data\n        });\n      }).catch(function (error) {\n        console.log(\"Error\", error);\n      });\n      console.log(this.state.checkCookie);\n    };\n\n    this.handleClick = () => {\n      console.log('checkLogin');\n\n      let isValud = this._isFormValid();\n\n      if (isValud == true) {\n        console.log('Valid');\n        let password = this.state.password;\n        let userName = this.state.userName;\n        var self = this;\n        axios.get(\"http://localhost:5000/checkLogin?name=\".concat(userName, \"&password=\").concat(password), {\n          withCredentials: true\n        }).then(function (response) {\n          console.log('currentUser', response.data);\n          self.setState({\n            currentUser: response.data\n          });\n          this.setLogin();\n        }).catch(function (error) {\n          console.log(error);\n        });\n      } else {\n        if (this.state.errorName) {\n          alert(this.state.errorName);\n        }\n\n        if (this.state.errorPassword) {\n          alert(this.state.errorPassword);\n        }\n      }\n    };\n\n    this.setLogin = () => {\n      let localUser = this.state.currentUser;\n\n      if (localUser !== {}) {\n        localStorage.currentUser = JSON.stringify(localUser); //save user to localstorage \n\n        this.setState({\n          isLoggedIn: true\n        });\n\n        if (localUser.role == \"1\") {\n          this.setState({\n            isAdmin: true\n          });\n          console.log(\"isAdmin\", this.state.isAdmin);\n        } else {\n          this.setState({\n            isAdmin: false\n          });\n          console.log(\"isAdmin\", this.state.isAdmin);\n        }\n      } else {\n        alert('Name or password incorrect!');\n      }\n    };\n\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  //  componentDidMount=()=>{\n  //   {   \n  //     var self=this;\n  //     axios.get(`http://localhost:4000/checkLogin?name=${name}&password=${password}`,{withCredentials:true})\n  //     .then(function(response){\n  //       console.log('isLoggedIn',response.data);\n  //      self.setState({ isLoggedIn: response.data });\n  //     })\n  //     .catch(function(error){\n  //        console.log(error);\n  //     });\n  //     }\n  //    }\n  //Validation userName and password\n  _isFormValid() {\n    return this._isNameValid(this.state.username) && this._isPassValid(this.state.password);\n  }\n\n  _isNameValid(username) {\n    let isValid = true;\n    let errorName = '';\n\n    if (username === '') {\n      errorName = 'Name is empty!';\n      isValid = false;\n      this.setState({\n        errorName: errorName\n      });\n      return isValid;\n    }\n\n    if (username.length < 3) {\n      errorName = 'Name must have 3 symbols minimum!';\n      isValid = false;\n      this.setState({\n        errorName: errorName\n      });\n      return isValid;\n    }\n  }\n\n  _isPassValid(password) {\n    let isValid = true;\n    let errorPassword = '';\n\n    if (password === '') {\n      errorPassword = 'Password is empty!';\n      isValid = false;\n      this.setState({\n        errorName: errorPassword\n      });\n      return isValid;\n    }\n  } // Check Login  \n\n\n  render() {\n    // if (this.state.isLoggedIn == true && this.state.isAdmin ==true){ \n    //   return  <Redirect to=\"/HomeUser\"/>\n    //  }\n    //  if (this.state.isLoggedIn == true && this.state.isAdmin ==false){   // redirect to Admin/User\n    //   return  <Redirect to=\"/Home\"/>\n    //  }\n    console.log(\"checkCookie\", this.state.checkCookie);\n    let loggedIn = this.state.checkCookie === '1';\n    console.log(\"LOGGWD\", loggedIn);\n    console.log(\"userRole\", this.state.userRole);\n\n    if (loggedIn == true && this.state.userRole == '0') {\n      return React.createElement(Redirect, {\n        to: \"/HomeAdmin\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      });\n    }\n\n    if (loggedIn == true && this.state.userRole == '1') {\n      // redirect to Admin/User\n      return React.createElement(Redirect, {\n        to: \"/HomeUser\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      });\n    }\n\n    if (loggedIn == false) {\n      // redirect to Login/Registration\n      return React.createElement(Redirect, {\n        to: \"/Login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      });\n    }\n\n    return React.createElement(BrowserRouter, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(MDBContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, React.createElement(MDBRow, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, React.createElement(MDBCol, {\n      md: \"6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, React.createElement(MDBCard, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, React.createElement(MDBCardBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"h4 text-center py-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, \"Login\"), React.createElement(\"div\", {\n      className: \"grey-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, React.createElement(MDBInput, {\n      label: \"Your name\",\n      icon: \"user\",\n      group: true,\n      type: \"text\",\n      validate: true,\n      error: \"wrong\",\n      success: \"right\",\n      onChange: (event, target) => this.setState({\n        username: event.target.value\n      }) // onChange={this.changeName}\n      ,\n      value: this.state.username,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }), React.createElement(MDBInput, {\n      label: \"Your password\",\n      icon: \"lock\",\n      group: true,\n      type: \"password\",\n      validate: true,\n      onChange: (event, target) => this.setState({\n        password: event.target.value\n      }) // onChange={this.changePassword}\n      ,\n      value: this.state.password,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"text-center py-4 mt-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247\n      },\n      __self: this\n    }, React.createElement(MDBBtn, {\n      color: \"cyan\",\n      type: \"submit\",\n      onClick: () => this.handleClick(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248\n      },\n      __self: this\n    }, \"LOGIN\"))), React.createElement(MDBModalFooter, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"font-weight-light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, \"Not a member? \", React.createElement(Link, {\n      to: \"/Registration\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, \"Sign Up\"))))))))), React.createElement(Route, {\n      path: \"/Registration\",\n      exact: true,\n      component: Registration,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["/Users/annapryadko/Desktop/GitHub/ReactProjectVacations/projectvacations/src/Components/Login/Login.js"],"names":["React","Component","axios","MDBMask","MDBView","MDBContainer","MDBRow","MDBCol","MDBInput","MDBBtn","MDBCard","MDBCardBody","MDBModalFooter","BrowserRouter","Route","Link","Switch","Redirect","Registration","Login","constructor","props","context","state","userName","password","errorName","errorPassword","currentUser","isLoginSuccess","foundUsers","isLoggedIn","cookieArr","checkCookie","userRole","componentDidMount","localStorage","currUser","JSON","parse","setState","data","role","self","get","withCredentials","then","response","console","log","catch","error","handleClick","isValud","_isFormValid","setLogin","alert","localUser","stringify","isAdmin","bind","_isNameValid","username","_isPassValid","isValid","length","render","loggedIn","event","target","value"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from \"axios\";\n//import Registration from './MyReg';\nimport { MDBMask, MDBView,MDBContainer, MDBRow, MDBCol, MDBInput, MDBBtn, MDBCard, MDBCardBody,MDBModalFooter } from 'mdbreact';\nimport { BrowserRouter } from 'react-router-dom'\nimport { Route, Link, Switch, Redirect} from 'react-router-dom';\n\nimport Registration from '../Registration/Registration';\n// import HomeUser from '../Home/HomeUser';\n// import HomeAdmin from '../Home/HomeAdmin';\n\n// import MuiThemeProvider from 'material-ui/styles/MuiThemeProvider';\n// import AppBar from 'material-ui/AppBar';\n// import RaisedButton from 'material-ui/RaisedButton';\n// import TextField from 'material-ui/TextField';\n\nclass Login extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n\n  state={\n    userName:\"\",\n    password:\"\",\n\n    errorName:\"\",\n    errorPassword:\"\",\n\n    currentUser:{},\n    isLoginSuccess:\"\",\n\n    foundUsers:[],\n    isLoggedIn: false,\n    // isAdmin:false,\n\n    cookieArr:[],\n\n    checkCookie:\"\",\n    userRole:\"\",\n    \n    currentUser:{},\n   }\n\n   componentDidMount=()=>{\n        \n    if (localStorage.currentUser) {\n      let currUser = JSON.parse(localStorage.currentUser) \n      this.setState({ currentUser: currUser });\n      this.setState({ userRole: currUser.data[0].role });\n      \n }\n\n    var self=this;\n    axios.get(`http://localhost:5000/checkCookie`,{withCredentials:true})\n    .then(function(response){\n      \n     console.log('checkCookie',response.data); // 1 or 0\n    \n     self.setState({ checkCookie: response.data });\n\n    })\n    .catch(function(error){\n       console.log(\"Error\",error);\n    });\n    console.log(this.state.checkCookie);\n\n  }\n  \n\n    //  componentDidMount=()=>{\n    //   {   \n    //     var self=this;\n    //     axios.get(`http://localhost:4000/checkLogin?name=${name}&password=${password}`,{withCredentials:true})\n    //     .then(function(response){\n          \n    //       console.log('isLoggedIn',response.data);\n          \n    //      self.setState({ isLoggedIn: response.data });\n    //     })\n    //     .catch(function(error){\n    //        console.log(error);\n    //     });\n    \n    //     }\n    //    }\n\n//Validation userName and password\n\n_isFormValid() {\n  return this._isNameValid(this.state.username) && this._isPassValid(this.state.password)\n}\n\n_isNameValid(username) {\n  let isValid=true;\n  let errorName='';\n\n  if (username==='') {\n    errorName='Name is empty!';\n    isValid=false;\n    this.setState({errorName:errorName});\n    return isValid;\n  } \n\n  if (username.length < 3) {\n    errorName='Name must have 3 symbols minimum!';\n    isValid=false;\n    this.setState({errorName:errorName});\n    return isValid;\n  } \n}\n\n_isPassValid(password) {\n  let isValid=true;\n  let errorPassword='';\n\n  if (password==='') {\n    errorPassword='Password is empty!';\n    isValid=false;\n    this.setState({errorName:errorPassword});\n    return isValid;\n  } \n}\n      \n// Check Login  \n\nhandleClick=()=>{ \n    console.log('checkLogin')\n    let isValud=this._isFormValid();\n        if (isValud==true) {\n          console.log('Valid')\n          let password=this.state.password;\n          let userName=this.state.userName; \n          var self=this;\n          axios.get(`http://localhost:5000/checkLogin?name=${userName}&password=${password}`,{withCredentials:true})\n          .then(function(response){\n            \n          console.log('currentUser',response.data);\n            \n          self.setState({ currentUser: response.data });\n\n          this.setLogin();  \n          })\n          .catch(function(error){\n            console.log(error);\n          });\n        } \n        else {\n          if (this.state.errorName) {alert(this.state.errorName);}\n          if (this.state.errorPassword) {alert(this.state.errorPassword);}\n         }\n\n      } \n\n    setLogin=()=>{       \n        let localUser = this.state.currentUser;\n\n          if(localUser!=={}){  \n            localStorage.currentUser=JSON.stringify(localUser); //save user to localstorage \n            this.setState({isLoggedIn:true})    \n            \n            if (localUser.role==\"1\")\n                 {\n                  this.setState({isAdmin: true});\n                  console.log(\"isAdmin\",this.state.isAdmin)    \n                 } \n                 else \n                   {\n                     this.setState({isAdmin: false});\n                     console.log(\"isAdmin\",this.state.isAdmin)\n                   }          \n                  }  \n                  else {\n                    alert('Name or password incorrect!')\n                  } \n                 }\n                 \n    render() {\n\n      // if (this.state.isLoggedIn == true && this.state.isAdmin ==true){ \n      //   return  <Redirect to=\"/HomeUser\"/>\n      //  }\n      //  if (this.state.isLoggedIn == true && this.state.isAdmin ==false){   // redirect to Admin/User\n      //   return  <Redirect to=\"/Home\"/>\n      //  }\n\n\n      console.log(\"checkCookie\", this.state.checkCookie)\n\n      let loggedIn = this.state.checkCookie === '1'\n   \n      console.log(\"LOGGWD\", loggedIn)\n      console.log(\"userRole\", this.state.userRole)\n   \n       if (loggedIn == true && this.state.userRole =='0'){ \n         return  <Redirect to=\"/HomeAdmin\"/>\n        }\n        \n        if (loggedIn == true && this.state.userRole =='1'){   // redirect to Admin/User\n         return  <Redirect to=\"/HomeUser\"/>\n        }\n       \n        if (loggedIn == false){   // redirect to Login/Registration\n         return  <Redirect to=\"/Login\"/>\n        }\n       \n\n        return (\n          <BrowserRouter>\n            {/* <MDBView src=\"https://mdbootstrap.com/img/Photos/Others/img%20(40).jpg\" fixed=\"top\">\n            <MDBMask overlay=\"purple-light\" className=\"flex-center flex-column text-white text-center\">\n              */}\n            <MDBContainer>\n              <MDBRow>\n                <MDBCol md=\"6\">\n                  <MDBCard>\n                    <MDBCardBody>\n                      <form>\n                        <p className=\"h4 text-center py-4\">Login</p>\n                        <div className=\"grey-text\">\n                          <MDBInput\n                            label=\"Your name\"\n                            icon=\"user\"\n                            group\n                            type=\"text\"\n                            validate\n                            error=\"wrong\"\n                            success=\"right\"\n                            onChange = {(event,target) => this.setState({username:event.target.value})}\n                            // onChange={this.changeName}\n                            value={this.state.username}\n                          />\n                          <MDBInput\n                            label=\"Your password\"\n                            icon=\"lock\"\n                            group\n                            type=\"password\"\n                            validate\n                            onChange = {(event,target) => this.setState({password:event.target.value})}\n                            // onChange={this.changePassword}\n                            value={this.state.password}\n                          />\n                        </div>\n                        <div className=\"text-center py-4 mt-3\">\n                          <MDBBtn color=\"cyan\" type=\"submit\" onClick={() =>this.handleClick()}>\n                            LOGIN\n                          </MDBBtn>\n                        </div>\n                      </form>\n                      <MDBModalFooter>\n                <div className=\"font-weight-light\">\n                  <p>Not a member? <Link to=\"/Registration\">Sign Up</Link></p>\n                  \n                  {/* <p>Forgot Password?</p> */}\n                </div>\n               \n              </MDBModalFooter>\n                    </MDBCardBody>\n                  </MDBCard>\n                </MDBCol>\n              </MDBRow>\n            \n            </MDBContainer>\n            {/* </MDBMask>\n          </MDBView> */}\n            \n          \n            <Route path=\"/Registration\" exact component={Registration} />\n            \n            </BrowserRouter>\n          );\n        };\n      }   \n  export default Login;\n  "]},"metadata":{},"sourceType":"module"}